<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button class="backbutton"></ion-back-button>
    </ion-buttons>
    <ion-title class="toolbartitle">Project Name</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <ng-container *ngIf="note">
    <div class="card-anotacion p-4 mb-4">
      <ion-label class="textAlabel mb-3" position="fixed">Anotaci√≥n</ion-label>
      <ion-textarea class="textArea mt-0" style="--padding-start: 0 !important;" autoGrow="True" readonly value="{{ note.body }}">
      </ion-textarea>
      <div *ngIf="note.imageUrls" class="slide-evidencias mb-3" >
        <img *ngFor="let img of note.imageUrls" [src]="img" alt="" srcset="">
      </div>
      <ion-label class="time-anotacion d-flex align-items-center justify-content-end gap-1">
        <ion-icon name="time-outline"></ion-icon>11:00 a.m.
      </ion-label>
      <ion-label class="date-anotacion d-flex align-items-center justify-content-end gap-1">
        <ion-icon name="calendar-outline"></ion-icon>{{ formatDateString(note.dateIsoString) }}
      </ion-label>
    </div>

    <div  class="line mb-4" >

      <ng-container *ngIf="note.signatureBase64 && note.signatureImageUrl; else elseTemplate">
        <img *ngIf="note.signatureImageUrl" [src]="note.signatureImageUrl" alt="firma" style=" max-width: 200px;">
        <div class="line-base">
          <span class="iconify" data-icon="fluent:signature-16-regular" style="font-size: 32px;"></span>
        </div>
        <ion-label class="mt-2 w-100">Responsable: {{ note.signatureUser.names }} {{ note.signatureUser.lastNames }}</ion-label>
        <ion-label class="w-100" style="font-size: 12px; color: #949494;">Firmado el {{ formatDateString(note.signatureDate) }}</ion-label>
      </ng-container>
      
      <ng-template #elseTemplate>
        <app-signature [note]="note" [user]="user" *ngIf="userCanSign()">
        </app-signature>
      </ng-template>

      <!--<ng-container *ngFor="let img of note.imageUrls">
        <img [src]="img" alt="" srcset="" style="max-height: 300px;">
      </ng-container>-->

    </div>

    <ng-container *ngIf="comments">
      <div class="card-comentarios py-4">
        <div class="comment-label px-4 mb-3">
          <ion-label>Comentarios</ion-label>
        </div>
        <div *ngFor="let comment of comments" class="comentario-item px-4 py-2">
          <ion-label class="comentador">{{ comment.user.names }} {{ comment.user.lastNames }}</ion-label>
          <ion-textarea class="textArea" autoGrow="True" readonly [value]="comment.body" style="--padding-start: 0; --padding-top: 0; --padding-bottom: 0">
          </ion-textarea>
          <ion-label class="comment-date gap-1 mb-1" slot="end">
            <ion-icon name="calendar-outline"></ion-icon>{{ formatDateString(comment.createdAt) }}
          </ion-label>
        </div>
      </div>
    </ng-container>

    <div class="floatingbutton">
      <ion-fab-button [routerLink]="['/comment-create/'+note.id]" class="addbutton">
        <ion-icon class="addicon" name="pencil-outline"></ion-icon>
      </ion-fab-button>
    </div>
  </ng-container>
</ion-content>
